import{_ as s,c as a,a as p,o as e}from"./app-BD3X-Yt7.js";const t={};function l(o,n){return e(),a("div",null,[...n[0]||(n[0]=[p(`<h2 id="响应式进阶" tabindex="-1"><a class="header-anchor" href="#响应式进阶"><span>响应式进阶</span></a></h2><h3 id="shallowref" tabindex="-1"><a class="header-anchor" href="#shallowref"><span>shallowRef()</span></a></h3><p>创建一个<strong>浅层响应式</strong>的引用, <code>shallowRef</code> 只会对其 <code>.value</code> 属性进行响应式处理，而不会递归地对其内部属性进行响应式转换</p><ul><li>不对引用类型的深层进行响应式处理; 只有对 <code>.value</code> 的访问是响应式的</li><li>用于对大型数据结构的性能优化或是与外部的状态管理系统集成</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// 浅响应式基础类型</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> shallowRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> msg <span class="token operator">=</span> <span class="token function">shallowRef</span><span class="token punctuation">(</span><span class="token string">&#39;大哥&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token function">shallowRef</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token function">shallowRef</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">123</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">handler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">	msg<span class="token punctuation">.</span>value <span class="token operator">=</span>  <span class="token string">&quot;请问&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    arr<span class="token punctuation">.</span>value <span class="token operator">=</span>  <span class="token string">&quot;可以&quot;</span><span class="token punctuation">;</span></span>
<span class="line">    arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">66666</span><span class="token punctuation">;</span>  <span class="token comment">// 不可以</span></span>
<span class="line">    arr<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;不可以&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 不可以</span></span>
<span class="line">    obj<span class="token punctuation">.</span>name<span class="token operator">=</span> <span class="token number">88</span>	<span class="token comment">// 不可以</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>reactive响应式数据不能直接修改整体</li><li>通过ref设置数据将全部响应式化, 但有时不需要引用数据全部响应式化,</li><li>通过 <code>shallowRef </code>不会将对引用类型进行深层响应式化, 从而达到性能优化并且修改整体</li></ul><h3 id="shallowreactive" tabindex="-1"><a class="header-anchor" href="#shallowreactive"><span>shallowReactive()</span></a></h3><p>创建一个<strong>浅层响应式</strong>对象, <code>shallowReactive</code> 只会对对象的顶层属性进行响应式处理，而不会递归地对其嵌套属性进行响应式转换。</p><ul><li>浅层响应式对象里只有根级别的属性是响应式的; 性能优化</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// 浅响应式对象</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> shallowReactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token function">shallowReactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;风&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">valueOf</span><span class="token operator">:</span><span class="token punctuation">{</span> <span class="token literal-property property">jia</span><span class="token operator">:</span><span class="token punctuation">{</span> <span class="token literal-property property">sss</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">	</span>
<span class="line">person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;qweqweq&quot;</span>					 <span class="token comment">// 可修改</span></span>
<span class="line">person<span class="token punctuation">.</span>valueOf<span class="token punctuation">.</span>jia<span class="token punctuation">.</span>sss <span class="token operator">=</span> <span class="token string">&quot;qweqweq&quot;</span>   	 <span class="token comment">// 不可修改</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="shallowreadonly" tabindex="-1"><a class="header-anchor" href="#shallowreadonly"><span>shallowReadonly()</span></a></h3><ul><li>接受一个响应式对象返回一个只读代理的原值。</li><li>一个对象响应式数据变为只读的（浅只读）代理(根层级的属性变为只读)</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// 浅只读数据</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> shallowReadonly<span class="token punctuation">,</span> reactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;路遥&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">ss</span><span class="token operator">:</span><span class="token punctuation">{</span> <span class="token literal-property property">qwe</span><span class="token operator">:</span><span class="token string">&quot;真难&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  </span>
<span class="line"><span class="token keyword">let</span> readValue <span class="token operator">=</span> <span class="token function">shallowReadonly</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span></span>
<span class="line">readValue<span class="token punctuation">.</span>name <span class="token operator">=</span>  <span class="token string">&quot;jiuwei&quot;</span>     <span class="token comment">// 不可修改</span></span>
<span class="line">readValue<span class="token punctuation">.</span>ss<span class="token punctuation">.</span>qwe <span class="token operator">=</span> <span class="token string">&quot;jiuwei&quot;</span>    <span class="token comment">// 可修改</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="toraw" tabindex="-1"><a class="header-anchor" href="#toraw"><span>toRaw()</span></a></h3><p>将响应式对象（由 <code>reactive</code>定义的响应式）转换为普通对象</p><ul><li>返回由 reactive()、readonly()、shallowReactive() 或者 shallowReadonly() 创建的代理对应的原始对象。</li><li>作用: 用于临时读取而不引起代理访问/跟踪开销，或是写入而不触发更改的特殊方法</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> toRaw<span class="token punctuation">,</span> reactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span></span>
<span class="line"><span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;风&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">valueOf</span><span class="token operator">:</span><span class="token punctuation">{</span> <span class="token literal-property property">jia</span><span class="token operator">:</span><span class="token punctuation">{</span> <span class="token literal-property property">sss</span><span class="token operator">:</span><span class="token number">16</span><span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> newperson <span class="token operator">=</span> <span class="token function">toRaw</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 视图不会变化</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">handler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">  newperson<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token number">7777</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 作用:  比如需要通过 copy一份数据进行处理, 直接赋值引用地址还是一个地址,修改还是相同的, </span></span>
<span class="line"><span class="token keyword">let</span> b <span class="token operator">=</span> person</span>
<span class="line">b<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token number">7777</span></span>
<span class="line"><span class="token comment">// person也会发生变化</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="markraw" tabindex="-1"><a class="header-anchor" href="#markraw"><span>markRaw</span></a></h3><p>标记一个对象，使其不能成为一个响应式对象</p><ul><li><p>有些值不应被设置为响应式的，例如复杂的第三方类库等。</p></li><li><p>当渲染具有不可变数据源的大列表时，跳过响应式转换可以提高性能</p></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span>markRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;lsh&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">obj <span class="token operator">=</span> <span class="token function">markRaw</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="customref" tabindex="-1"><a class="header-anchor" href="#customref"><span>customRef</span></a></h3><blockquote><p><code>customRef</code> 是 Vue 3 中提供的一个 API，允许开发者创建自定义的、具有显式依赖追踪和更新触发逻辑的响应式引用（Ref）</p></blockquote><p><code>customRef</code> 接受一个工厂函数, 该函数返回一个包含 <code>get</code> 和 <code>set</code> 方法的对象</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> myRef <span class="token operator">=</span> <span class="token function">customRef</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;获取myRef时触发&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token comment">// 追踪依赖（当值被访问时）</span></span>
<span class="line">      <span class="token keyword">return</span> <span class="token number">777</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;设置myRef时触发&quot;</span><span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 自定义ref, ref功能延迟1秒在修改</span></span>
<span class="line"><span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>MyRef<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> customRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">useDebouncedRef</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 设置返回值在页面显示,没有功能</span></span>
<span class="line">    <span class="token comment">// 通过customRef函数进行设置一个回调函数</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">customRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">track<span class="token punctuation">,</span>trigger</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// return 返回对象并设置get函数返回数据</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">{</span> </span>
<span class="line">            <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">// 设置track函数 进行依赖收集并追踪依赖</span></span>
<span class="line">                <span class="token comment">// 告诉 Vue：当前有代码依赖这个值！</span></span>
<span class="line">                <span class="token function">track</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword">return</span> value</span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                value <span class="token operator">=</span> newValue<span class="token punctuation">;</span></span>
<span class="line">                <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 视图依赖数据更新 </span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// 设置一个函数进行传递参数</span></span>
<span class="line"><span class="token keyword">let</span> MyRef <span class="token operator">=</span> <span class="token function">useDebouncedRef</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>track() 的作用 <ul><li>当在 <code>get()</code> 方法中调用 <code>track()</code> 时，Vue 会记录当前正在访问该值的代码位置</li><li><strong>用途</strong>：告诉 Vue：“当前有代码依赖这个值，如果值变化了，需要通知这些依赖方更新！”</li><li><strong>不调用的后果</strong>：如果忘记调用 <code>track()</code>，即使值变化了，依赖它的组件或计算属性<strong>不会自动更新</strong>。</li></ul></li><li>trigger() 的作用</li><li>当在 <code>set()</code> 方法中调用 <code>trigger()</code> 时，Vue 会通知所有依赖该值的地方（如组件模板、计算属性等）重新执行或渲染</li><li><strong>用途</strong>：告诉 Vue：“值已经变了，所有依赖我的地方快更新！”</li><li><strong>不调用的后果</strong>：如果忘记调用 <code>trigger()</code>，即使值改变了，界面会<strong>停留在旧值</strong></li></ul><blockquote><p>防抖设置</p></blockquote><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;nav&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;MyRef&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>MyRef<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> customRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@vue/reactivity&#39;</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">useDebouncedRef</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> timeout <span class="token operator">=</span> <span class="token keyword">null</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">customRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">track<span class="token punctuation">,</span>trigger</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">{</span> </span>
<span class="line">            <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">track</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token keyword">return</span> value</span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">//输入过快会出现问题,设置防抖   </span></span>
<span class="line">                <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span></span>
<span class="line">                timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">                    value <span class="token operator">=</span> newValue<span class="token punctuation">;</span></span>
<span class="line">                    <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> </span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// 设置一个函数进行传递参数</span></span>
<span class="line"><span class="token keyword">let</span> MyRef <span class="token operator">=</span> <span class="token function">useDebouncedRef</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="组合式函数" tabindex="-1"><a class="header-anchor" href="#组合式函数"><span>组合式函数</span></a></h2><blockquote><p><strong>本质</strong>: 一个普通的 JavaScript 函数，内部使用了 Vue 的组合式 API</p></blockquote><p>将组件中的<strong>逻辑关注点</strong>（如数据管理、副作用处理）抽离为独立单元，实现逻辑复用</p><p><strong>特点</strong>：</p><ul><li>以 <code>use</code> 开头命名（约定，例如 <code>useMouse</code>, <code>useFetch</code>）</li><li>返回响应式状态和方法 <ul><li>数据是不公通的,逻辑是公用的</li><li>组合式函数返回多个数据,函数</li></ul></li><li>可在多个组件中复用</li></ul><p>相当于选项式的混入mixin</p><h2 id="响应式工具" tabindex="-1"><a class="header-anchor" href="#响应式工具"><span>响应式工具</span></a></h2><h3 id="isref" tabindex="-1"><a class="header-anchor" href="#isref"><span>isRef</span></a></h3><p>检查一个值是否为一个 ref 对象</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">let</span> qq <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&quot;App数据&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> www <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;路遥&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isRef</span><span class="token punctuation">(</span>www<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="isreactive" tabindex="-1"><a class="header-anchor" href="#isreactive"><span>isReactive</span></a></h3><p>检查一个对象是否是由 reactive() 或 shallowReactive() 创建的代理。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">let</span> qq <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&quot;App数据&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> www <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;路遥&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isReactive</span><span class="token punctuation">(</span>www<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="unref" tabindex="-1"><a class="header-anchor" href="#unref"><span>unref</span></a></h3><p>如果参数是 ref，则返回内部值，否则返回参数本身</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">let</span> qq <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&quot;App数据&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> qq <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> ss <span class="token operator">=</span> <span class="token function">unref</span><span class="token punctuation">(</span>qq<span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">// val = isRef(val) ? val.value : val 计算的一个语法糖</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="toref" tabindex="-1"><a class="header-anchor" href="#toref"><span>toRef</span></a></h3><p>为源响应式对象上的某个属性新创建一个ref。然后ref可以被传递，一直保持对其源属性响应式连接在一起</p><ul><li>语法：<code>const name = toRef(person,&#39;name&#39;)</code></li><li>应用: 要将响应式对象中的某个属性单独提供给外部使用时。</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> toRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> www <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;路遥&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// 设置toRef(www, &quot;name&quot;) 修改会更新视图</span></span>
<span class="line"><span class="token keyword">let</span> <span class="token punctuation">{</span> handlerValue <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useHnadler</span><span class="token punctuation">(</span><span class="token function">toRef</span><span class="token punctuation">(</span>www<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 组合式函数</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useHnadler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token function-variable function">handlerValue</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    obj<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&quot;大哥&quot;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">    handlerValue</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 内部执行会触发响应式</span></span>
<span class="line"><span class="token function">useHnadler</span><span class="token punctuation">(</span>www<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意: 如果提供一个整体,响应式还是存储; 提供单个属性响应式不存在</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> toRef <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span></span>
<span class="line"><span class="token comment">// 组合式函数</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useCeshi</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> www <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;路遥&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  </span>
<span class="line">  <span class="token comment">// 不设置不存在响应式</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token function">toRef</span><span class="token punctuation">(</span>www<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 组件</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>  name<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&quot;久违&quot;</span> <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="torefs" tabindex="-1"><a class="header-anchor" href="#torefs"><span>toRefs</span></a></h3><p>将响应式对象转换为普通对象，其中对象的每个属性都是指向原始对象相应属性的连接在一起</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// 解构返回值对象时会失去响应, 通过torefs 或 toref都行</span></span>
<span class="line"><span class="token keyword">let</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> handleruseObj <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useObj</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useObj</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">let</span> <span class="token function-variable function">handleruseObj</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    a<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;1111111111&quot;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token operator">...</span><span class="token function">toRefs</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    handleruseObj</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">    </span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token function">toRef</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    handleruseObj</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,53)])])}const i=s(t,[["render",l]]),u=JSON.parse('{"path":"/vue/vue3-12%E7%BB%84%E5%90%88%E5%BC%8FAPI.html","title":"","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"响应式进阶","slug":"响应式进阶","link":"#响应式进阶","children":[{"level":3,"title":"shallowRef()","slug":"shallowref","link":"#shallowref","children":[]},{"level":3,"title":"shallowReactive()","slug":"shallowreactive","link":"#shallowreactive","children":[]},{"level":3,"title":"shallowReadonly()","slug":"shallowreadonly","link":"#shallowreadonly","children":[]},{"level":3,"title":"toRaw()","slug":"toraw","link":"#toraw","children":[]},{"level":3,"title":"markRaw","slug":"markraw","link":"#markraw","children":[]},{"level":3,"title":"customRef","slug":"customref","link":"#customref","children":[]}]},{"level":2,"title":"组合式函数","slug":"组合式函数","link":"#组合式函数","children":[]},{"level":2,"title":"响应式工具","slug":"响应式工具","link":"#响应式工具","children":[{"level":3,"title":"isRef","slug":"isref","link":"#isref","children":[]},{"level":3,"title":"isReactive","slug":"isreactive","link":"#isreactive","children":[]},{"level":3,"title":"unref","slug":"unref","link":"#unref","children":[]},{"level":3,"title":"toRef","slug":"toref","link":"#toref","children":[]},{"level":3,"title":"toRefs","slug":"torefs","link":"#torefs","children":[]}]}],"git":{},"filePathRelative":"vue/vue3-12组合式API.md"}');export{i as comp,u as data};
