import{_ as s,c as a,a as p,o as e}from"./app-DWS4XIiF.js";const t="/book/assets/day33-postman%E4%BD%BF%E7%94%A8-DbFLj1Eb.png",l="/book/assets/day33-postman%E4%BD%BF%E7%94%A82-DOwdXARi.png",o="/book/assets/day33-postman%E4%BD%BF%E7%94%A83-BXUcxSeD.png",c={};function i(u,n){return e(),a("div",null,[...n[0]||(n[0]=[p(`<h1 id="drf-django-restframework" tabindex="-1"><a class="header-anchor" href="#drf-django-restframework"><span>drf(django restframework)</span></a></h1><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 快速上手</span></span>
<span class="line"><span class="token comment"># 请求的封装</span></span>
<span class="line"><span class="token comment"># 版本管理(了解)</span></span>
<span class="line"><span class="token comment"># 认证</span></span>
<span class="line"><span class="token comment"># 权限</span></span>
<span class="line"><span class="token comment"># 限流</span></span>
<span class="line"><span class="token comment"># 序列化</span></span>
<span class="line"><span class="token comment"># 视图</span></span>
<span class="line"><span class="token comment"># 条件搜索</span></span>
<span class="line"><span class="token comment"># 分页</span></span>
<span class="line"><span class="token comment"># 路由</span></span>
<span class="line"><span class="token comment"># 解析器</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="快速上手" tabindex="-1"><a class="header-anchor" href="#快速上手"><span>快速上手</span></a></h2><ul><li>安装</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">pip install djangorestframework</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 如果报错版本不适配执行命令</span></span>
<span class="line">pip install djangorestframework <span class="token operator">-</span><span class="token operator">-</span>upgrade</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>配置</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 在settings.py中注册应用中将框架进行注册,后续才能使用drf框架中的功能</span></span>
<span class="line">INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.admin&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.auth&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.contenttypes&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.sessions&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.messages&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.staticfiles&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;app01.apps.App01Config&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;rest_framework&#39;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># drf后续所有相关配置写在settings.py中</span></span>
<span class="line">REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>进行数据库迁移</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">python manage<span class="token punctuation">.</span>py makemigrations</span>
<span class="line">python manage<span class="token punctuation">.</span>py migrate</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>url和视图</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 路由要以CBV的形式进行定义</span></span>
<span class="line">path<span class="token punctuation">(</span><span class="token string">&#39;users/&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>UserView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># views.py</span></span>
<span class="line"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>views <span class="token keyword">import</span> APIView</span>
<span class="line"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">UserView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;get请求&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;post请求&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>drf框架在django的基础上进行了扩展:</p><ul><li>as_view,免除了csrf的验证</li><li>dispath,内部添加了版本处理,认证,权限,访问频率等功能</li></ul><h2 id="postman模拟请求发送" tabindex="-1"><a class="header-anchor" href="#postman模拟请求发送"><span>postman模拟请求发送</span></a></h2><ul><li>先注册用户登录</li><li>添加新的collection(请求集合)</li></ul><img src="`+t+'"><ul><li><p>创建新的请求 <img src="'+l+'"></p></li><li><p>发送请求 <img src="'+o+`"></p></li></ul><h2 id="请求数据的封装" tabindex="-1"><a class="header-anchor" href="#请求数据的封装"><span>请求数据的封装</span></a></h2><p>以前通过django开发项目时,视图中的request对象是来自django.core.handles.wsgi.WSGIRequest类,其中包含了请求相关的所有数据</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">request<span class="token punctuation">.</span>method</span>
<span class="line">request<span class="token punctuation">.</span>POST</span>
<span class="line">request<span class="token punctuation">.</span>GET</span>
<span class="line">request<span class="token punctuation">.</span>body</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在使用drf框架时,视图的request是rest_framework.request.Request类的对象.</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">request<span class="token punctuation">.</span>query_params  <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>request<span class="token punctuation">.</span>GET<span class="token punctuation">(</span><span class="token punctuation">)</span> 本质上就是<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_request<span class="token punctuation">.</span>GET<span class="token punctuation">)</span></span>
<span class="line">request<span class="token punctuation">.</span>data <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>内部读取请求体中的数据<span class="token punctuation">,</span>并进行处理<span class="token punctuation">(</span>发送过来的请求是json格式的<span class="token punctuation">,</span>内部会自动对json字符串去进行反序列化<span class="token punctuation">)</span></span>
<span class="line">request<span class="token punctuation">.</span>method <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span>查看请求方法</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="版本管理" tabindex="-1"><a class="header-anchor" href="#版本管理"><span>版本管理</span></a></h2><p>在restful规范中要去后端接口中体现版本</p><h3 id="url的get参数传递" tabindex="-1"><a class="header-anchor" href="#url的get参数传递"><span>url的get参数传递</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># urls.py</span></span>
<span class="line">path<span class="token punctuation">(</span><span class="token string">&#39;users/&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>UserView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># views.py</span></span>
<span class="line"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>versioning <span class="token keyword">import</span> QueryParameterVersioning</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">UserView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    versioning_class <span class="token operator">=</span> QueryParameterVersioning</span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>version<span class="token punctuation">)</span>  <span class="token comment"># 获取到问号后面携带的版本</span></span>
<span class="line">        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;get请求&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    </span>
<span class="line"><span class="token comment"># 访问:</span></span>
<span class="line">http<span class="token punctuation">:</span><span class="token operator">//</span>localhost<span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>users<span class="token operator">/</span>?version<span class="token operator">=</span>v1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="url路径传递" tabindex="-1"><a class="header-anchor" href="#url路径传递"><span>url路径传递</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># urls.py</span></span>
<span class="line">path<span class="token punctuation">(</span><span class="token string">&#39;users/&lt;str:version&gt;/&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>UserView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&#39;users&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># views.py</span></span>
<span class="line"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>versioning <span class="token keyword">import</span> URLPathVersioning</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">UserView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    versioning_class <span class="token operator">=</span> URLPathVersioning</span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>version<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;get请求&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line"><span class="token comment"># 访问:</span></span>
<span class="line">http<span class="token punctuation">:</span><span class="token operator">//</span>localhost<span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>users<span class="token operator">/</span>v1<span class="token operator">/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="认证" tabindex="-1"><a class="header-anchor" href="#认证"><span>认证</span></a></h2><p>在开发后端接口时,不同功能会有不同的限制:</p><ul><li>无需认证,就可以访问并获取数据</li><li>需要认证,用户需要先登录,后续发送请求需要携带登录时发放的凭证</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># models.py</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    username <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;用户名&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    password <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;密码&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    token <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;TOKEN&#39;</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line"><span class="token comment"># 进行数据库迁移</span></span>
<span class="line"><span class="token comment"># 在手动输入一个用户</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>登录类</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># urls.py</span></span>
<span class="line">path<span class="token punctuation">(</span><span class="token string">&#39;auth/&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>AuthView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&#39;auth&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> </span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># views.py</span></span>
<span class="line"><span class="token keyword">import</span> uuid</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">AuthView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># 用户登录</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span></span>
<span class="line">        username <span class="token operator">=</span> request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        password <span class="token operator">=</span> request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;password&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>username<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token keyword">not</span> user_obj<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;用户名或密码错误&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        token <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 产生token验证</span></span>
<span class="line">        user_obj<span class="token punctuation">.</span>token <span class="token operator">=</span> token</span>
<span class="line">        user_obj<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">:</span> token<span class="token punctuation">,</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">:</span> username<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>登录认证类</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>authentication <span class="token keyword">import</span> BaseAuthentication</span>
<span class="line"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> AuthenticationFailed</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">MyAuthentication</span><span class="token punctuation">(</span>BaseAuthentication<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">authenticate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        token <span class="token operator">=</span> request<span class="token punctuation">.</span>query_params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token keyword">not</span> token<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">raise</span> AuthenticationFailed<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">&#39;error&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;认证失败&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>token<span class="token operator">=</span>token<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token keyword">not</span> user_obj<span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">raise</span> AuthenticationFailed<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">1001</span><span class="token punctuation">,</span> <span class="token string">&#39;error&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;认证失败&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># 返回值:(登录的用户对象, token)</span></span>
<span class="line">        <span class="token keyword">return</span> user_obj<span class="token punctuation">,</span> token</span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">authenticate_header</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># 请求头中体现接口信息</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token string">&#39;Bearer realm=&quot;API&quot;&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>需要用户登录才能访问的视图</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># urls.py</span></span>
<span class="line">path<span class="token punctuation">(</span><span class="token string">&#39;order/&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>OrderView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&#39;order&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">path<span class="token punctuation">(</span><span class="token string">&#39;pay/&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>PayView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&#39;pay&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># views.py</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">OrderView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    authentication_classes <span class="token operator">=</span> <span class="token punctuation">[</span>MyAuthentication<span class="token punctuation">,</span> <span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>user<span class="token punctuation">)</span>  <span class="token comment"># 当前登录的用户对象</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>auth<span class="token punctuation">)</span>  <span class="token comment"># 获取当前登录的用户对象的token</span></span>
<span class="line">        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;这是order视图&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">PayView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    authentication_classes <span class="token operator">=</span> <span class="token punctuation">[</span>MyAuthentication<span class="token punctuation">,</span> <span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>user<span class="token punctuation">)</span>  <span class="token comment"># 当前登录的用户对象</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>auth<span class="token punctuation">)</span>  <span class="token comment"># 获取当前登录的用户对象的token</span></span>
<span class="line">        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;这是pay视图&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>测试</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 登录</span></span>
<span class="line">post请求<span class="token punctuation">:</span>http<span class="token punctuation">:</span><span class="token operator">//</span>localhost<span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>auth<span class="token operator">/</span></span>
<span class="line">    请求体<span class="token punctuation">:</span>username</span>
<span class="line">          password</span>
<span class="line">返回值<span class="token punctuation">:</span>        </span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&quot;code&quot;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&quot;data&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&quot;token&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;27d1fd87-6165-42cc-997d-fb09389b34ba&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;xixi&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 返回需要登录的视图</span></span>
<span class="line"><span class="token comment"># OrderView</span></span>
<span class="line">get请求<span class="token punctuation">:</span>http<span class="token punctuation">:</span><span class="token operator">//</span>localhost<span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>order<span class="token operator">/</span>?token<span class="token operator">=</span>27d1fd87<span class="token operator">-</span><span class="token number">6165</span><span class="token operator">-</span>42cc<span class="token operator">-</span>997d<span class="token operator">-</span>fb09389b34ba</span>
<span class="line">            </span>
<span class="line"><span class="token comment"># PayView</span></span>
<span class="line">get请求<span class="token punctuation">:</span>http<span class="token punctuation">:</span><span class="token operator">//</span>localhost<span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>pay<span class="token operator">/</span>?token<span class="token operator">=</span>27d1fd87<span class="token operator">-</span><span class="token number">6165</span><span class="token operator">-</span>42cc<span class="token operator">-</span>997d<span class="token operator">-</span>fb09389b34ba</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="认证结果" tabindex="-1"><a class="header-anchor" href="#认证结果"><span>认证结果</span></a></h3><p>在视图类中设置类变量authentication_classes的值为认证类MyAuthentication,表示此是视图在执行内部功能之前需要先经过认证</p><p>认证类的内部就是去执行authenticate方法,根据返回值表示认证结果</p><ul><li><p>抛出异常AuthenticationFailed,表示认证失败.内部执行authenticate_header将返回值设置给响应头WWW-Authenticate</p></li><li><p>返回有两个元素的元组,表示认证成功,并且会将元组的第一个元素(用户对象)赋值给request.user,第二值(token)赋值给request.auth</p></li><li><p>返回None,表示调用后续的认证类进行认证(列表中可能有多个类,返回None表示跳过这个认证类执行下一个)</p><ul><li>当出现多个认证类是,drf内部会按照列表的顺序逐一执行认证类中的authenticate方法,如果返回元组或者抛出异常,则会终止后续认证类的执行.</li><li>如果所有认证类的authenticate都返回了None,则默认request.user是匿名用户和request.auth=None.可以通过修改配置文件类修改默认值</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># setting.py</span></span>
<span class="line">REST_FRAMEWORK <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;UNAUTHENTICATED_USER&#39;</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;UNAUTHENTICATED_TOKEN&#39;</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span><span class="token punctuation">:</span> <span class="token boolean">None</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="权限" tabindex="-1"><a class="header-anchor" href="#权限"><span>权限</span></a></h2><p>认证:根据携带的信息获取当前登录的用户(判断用户是否登录)</p><p>权限:读取认证中获取的用户信息,判断当前用户是否有权限访问(普通用户,vip, svip),不同用户具有不同的权限</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># models.py</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># 角色</span></span>
<span class="line">    role_choices <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;普通用户&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;vip&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;svip&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    role <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>role_choices<span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;角色&#39;</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    username <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;用户名&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    password <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;密码&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    token <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">&#39;TOKEN&#39;</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>依然需要登录类和认证类</p><ul><li>权限类</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> rest_framework<span class="token punctuation">.</span>permissions <span class="token keyword">import</span> BasePermission</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">MyPermission</span><span class="token punctuation">(</span>BasePermission<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    message <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">1003</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;无权访问&#39;</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">has_permission</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> view<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 判断当前登录的用户是否有权限访问某个视图</span></span>
<span class="line">        <span class="token keyword">if</span> request<span class="token punctuation">.</span>user<span class="token punctuation">.</span>role <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token boolean">True</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">False</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">has_object_permission</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> view<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># 判断当前登录的用户是否有权限访问某个用户的数据</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token boolean">True</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>需要经过权限校验的视图</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">OrderView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    authentication_classes <span class="token operator">=</span> <span class="token punctuation">[</span>MyAuthentication<span class="token punctuation">,</span> <span class="token punctuation">]</span></span>
<span class="line">    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>MyPermission<span class="token punctuation">,</span> <span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>user<span class="token punctuation">)</span>  <span class="token comment"># 当前登录的用户对象</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>auth<span class="token punctuation">)</span>  <span class="token comment"># 获取当前登录的用户对象的token</span></span>
<span class="line">        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;这是order视图&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">PayView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    authentication_classes <span class="token operator">=</span> <span class="token punctuation">[</span>MyAuthentication<span class="token punctuation">,</span> <span class="token punctuation">]</span></span>
<span class="line">    permission_classes <span class="token operator">=</span> <span class="token punctuation">[</span>MyPermission<span class="token punctuation">,</span> <span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>user<span class="token punctuation">)</span>  <span class="token comment"># 当前登录的用户对象</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>auth<span class="token punctuation">)</span>  <span class="token comment"># 获取当前登录的用户对象的token</span></span>
<span class="line">        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;code&#39;</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;data&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;这是pay视图&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>测试</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># OrderView</span></span>
<span class="line">get请求<span class="token punctuation">:</span>http<span class="token punctuation">:</span><span class="token operator">//</span>localhost<span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>order<span class="token operator">/</span>?token<span class="token operator">=</span>27d1fd87<span class="token operator">-</span><span class="token number">6165</span><span class="token operator">-</span>42cc<span class="token operator">-</span>997d<span class="token operator">-</span>fb09389b34ba</span>
<span class="line">            </span>
<span class="line"><span class="token comment"># PayView</span></span>
<span class="line">get请求<span class="token punctuation">:</span>http<span class="token punctuation">:</span><span class="token operator">//</span>localhost<span class="token punctuation">:</span><span class="token number">8000</span><span class="token operator">/</span>pay<span class="token operator">/</span>?token<span class="token operator">=</span>27d1fd87<span class="token operator">-</span><span class="token number">6165</span><span class="token operator">-</span>42cc<span class="token operator">-</span>997d<span class="token operator">-</span>fb09389b34ba</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="关于多个权限类" tabindex="-1"><a class="header-anchor" href="#关于多个权限类"><span>关于多个权限类</span></a></h3><p>当开发过程中需要用户同时具备多个权限(缺一不可)时,可以使用多个权限类来实现</p><p>内部处理:按照列表中的顺序逐一执行has_permission方法,如果返回True,则继续执行后续的权限类;如果返回None或者False,则排除异常并通知后续权限类的执行</p>`,58)])])}const k=s(c,[["render",i]]),d=JSON.parse('{"path":"/django/33-drf%E4%BB%8B%E7%BB%8D.html","title":"drf(django restframework)","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"快速上手","slug":"快速上手","link":"#快速上手","children":[]},{"level":2,"title":"postman模拟请求发送","slug":"postman模拟请求发送","link":"#postman模拟请求发送","children":[]},{"level":2,"title":"请求数据的封装","slug":"请求数据的封装","link":"#请求数据的封装","children":[]},{"level":2,"title":"版本管理","slug":"版本管理","link":"#版本管理","children":[{"level":3,"title":"url的get参数传递","slug":"url的get参数传递","link":"#url的get参数传递","children":[]},{"level":3,"title":"url路径传递","slug":"url路径传递","link":"#url路径传递","children":[]}]},{"level":2,"title":"认证","slug":"认证","link":"#认证","children":[{"level":3,"title":"认证结果","slug":"认证结果","link":"#认证结果","children":[]}]},{"level":2,"title":"权限","slug":"权限","link":"#权限","children":[{"level":3,"title":"关于多个权限类","slug":"关于多个权限类","link":"#关于多个权限类","children":[]}]}],"git":{},"filePathRelative":"django/33-drf介绍.md"}');export{k as comp,d as data};
