import{_ as s,c as a,a as p,o as t}from"./app-oYpRxrJy.js";const e={};function l(c,n){return t(),a("div",null,[...n[0]||(n[0]=[p(`<h2 id="ajax" tabindex="-1"><a class="header-anchor" href="#ajax"><span>AJAX</span></a></h2><p>用于创建交互式网页应用程序的Web开发技术。它结合了多种技术，包括JavaScript、XML、HTML和CSS，以实现在不重新加载整个页面的情况下，通过与服务器异步交互来更新部分页面内容的能力</p><p>AJAX利用了浏览器提供的XMLHttpRequest对象（现在更常用的是fetch API）来与服务器进行异步通信。通过发送HTTP请求并接收服务器返回的数据，可以动态更新页面的内容，而不需要刷新整个页面。这使得网页可以更加响应和交互，并提供更流畅的用户体验。</p><p>可使用<code>XML, fetch, Axios, </code> 其中一项完成交互</p><h2 id="原生请求" tabindex="-1"><a class="header-anchor" href="#原生请求"><span>原生请求</span></a></h2><h3 id="使用" tabindex="-1"><a class="header-anchor" href="#使用"><span>使用</span></a></h3><ul><li><p>创建XMLHttpRequest对象</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">let</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>打开和发送HTTP请求</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&#39;GET&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;server-url&#39;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 或者使用POST方法发送请求</span></span>
<span class="line">xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 在\`open\`方法中，第一个参数指定HTTP请求的方法（GET、POST等），第二个参数是服务器URL，第三个参数表示是否以异步方式发送请求（\`true\`表示异步，\`false\`表示同步）。</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>设置回调函数来处理服务器响应</p><ul><li>0: 未初始化- XMLHttpRequest对象已被创建，但尚未调用<code>open</code>方法。</li><li>1: 打开<code>open</code>方法已被调用。在这个状态下，可以设置请求头（<code>setRequestHeader</code>）。</li><li>2: 发送<code>send</code>方法已被调用，且响应头已被接收。在这个状态下，可以访问响应头信息。</li><li>3: 接收- 响应体正在被接收。在这个状态下，可以访问部分响应数据。</li><li>4: 完成- 响应已经完全接收，并且可以使用<code>responseText</code>或<code>responseXML</code>获取完整的响应数据。</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// 处理服务器响应的代码</span></span>
<span class="line">      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>这只是使用原生AJAX的基本示例。要使用POST方法发送数据，可以在<code>send</code>方法中传递要发送的数据作为参数。此外，还可以设置请求头、处理错误和超时等。</p><h3 id="携带参数" tabindex="-1"><a class="header-anchor" href="#携带参数"><span>携带参数</span></a></h3><ul><li>get: 地址后面设置?属性和属性值</li><li>post: <ul><li><code> xhr.setRequestHeader(&quot;Content-Type&quot;,&quot;application/json&quot;)</code></li><li><code> xhr.send(JSON.stringify({name:123}))</code></li></ul></li></ul><h3 id="请求区别" tabindex="-1"><a class="header-anchor" href="#请求区别"><span>请求区别</span></a></h3><ul><li>发送服务器数据量 <ul><li>get: 最多传 2k</li><li>post : 原则上没有限制</li></ul></li><li>安全方面: post相对而言数据传递较为安全</li><li>传递的数据格式不一样 <ul><li>get: 在url地址后边以请求字符串的形式传递参数</li><li>post: 是以json对象的方式传递</li></ul></li></ul><h2 id="状态码" tabindex="-1"><a class="header-anchor" href="#状态码"><span>状态码</span></a></h2><p>状态码是由服务器在响应请求时返回的三位数字代码，用于表示请求的处理状态</p><p>常见的HTTP状态码及其含义：</p><ul><li>200 OK：请求成功。服务器成功处理了请求，并返回所需的数据。</li><li>201 Created：已创建。服务器成功创建了新资源。</li><li>204 No Content：无内容。服务器成功处理了请求，但没有返回任何内容。</li><li>400 Bad Request：错误的请求。服务器无法理解或处理请求，通常由于请求中的语法错误。</li><li>401 Unauthorized：未经授权。请求需要身份验证，但用户未提供有效的凭据。</li><li>403 Forbidden：禁止访问。服务器拒绝请求的访问权限。</li><li>404 Not Found：未找到。服务器无法找到请求的资源。</li><li>500 Internal Server Error：服务器内部错误。服务器在处理请求时遇到了错误。</li></ul><h2 id="axios" tabindex="-1"><a class="header-anchor" href="#axios"><span>Axios</span></a></h2><p>基于Promise的现代JavaScript HTTP客户端库，用于在浏览器和Node.js中进行HTTP请求。它提供了一种简洁且易于使用的方式来发送异步HTTP请求，并处理响应数据</p><p>确保你已经在项目中引入了Axios库。可以通过使用CDN或安装使用包管理器（如npm或yarn）来获取<a href="https://www.axios-http.cn/docs/config_defaults" target="_blank" rel="noopener noreferrer">Axios地址</a></p><h3 id="基础使用" tabindex="-1"><a class="header-anchor" href="#基础使用"><span>基础使用</span></a></h3><ul><li>通过axios名称使用对应API</li><li>可设置<code>get post</code>请求</li></ul><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/axios/dist/axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"></span>
<span class="line">    <span class="token comment">//发起请求并携带参数</span></span>
<span class="line">    axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/user?ID=12345&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 处理成功情况</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 处理错误情况</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">	</span>
<span class="line">    <span class="token comment">// 发起请求并携带参数</span></span>
<span class="line">    axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/user&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">&#39;Fred&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">&#39;Flintstone&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>可以向 <code>axios</code> 传递相关配置来创建请求</p></blockquote><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// 发起一个post请求</span></span>
<span class="line"><span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&#39;post&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;/user/12345&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span> </span>
<span class="line">    <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">&#39;Fred&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">&#39;Flintstone&#39;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// data是post携带数据  params是get携带数据配置对象</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>默认配置</p></blockquote><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">&#39;https://api.example.com&#39;</span><span class="token punctuation">;</span>  <span class="token comment">// 设置默认请求头</span></span>
<span class="line">axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>common<span class="token punctuation">[</span><span class="token string">&#39;Authorization&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">AUTH_TOKEN</span><span class="token punctuation">;</span>  <span class="token comment">// 携带token数据</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>补充: 其他API可以到官网查询</p><h2 id="fetch" tabindex="-1"><a class="header-anchor" href="#fetch"><span>fetch</span></a></h2><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">//第一种</span></span>
<span class="line"><span class="token comment">// let data = {username: &#39;example&#39;};</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//  第二种</span></span>
<span class="line"><span class="token comment">// const params = new URLSearchParams();</span></span>
<span class="line"><span class="token comment">//  params.append(&#39;param1&#39;, &#39;value1&#39;);</span></span>
<span class="line"><span class="token comment">// params.append(&#39;param2&#39;, &#39;value2&#39;);</span></span>
<span class="line"></span>
<span class="line">    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:3000/ni&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">        method<span class="token operator">:</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        mode<span class="token operator">:</span><span class="token string">&#39;no-cors&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        headers<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">&quot;Content-type&quot;</span><span class="token operator">:</span><span class="token string">&quot;application/x-www-form-urlencoded&quot;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span> </span>
<span class="line">        body<span class="token operator">:</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//路径，各项参数</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// return res.json(); //将返回的数据格式化</span></span>
<span class="line">        <span class="token comment">// return res.text() // 字符串格式</span></span>
<span class="line">        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">rs</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//   get 不能带data数据  通过url</span></span>
<span class="line"><span class="token comment">//    post 才能带data数据  </span></span>
<span class="line"><span class="token comment">//   json数据格式   通过body传送到后端  设置请求头</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// headers: {</span></span>
<span class="line">            <span class="token comment">// 将发送的数据转化成 url地址信息格式解析读取</span></span>
<span class="line"><span class="token comment">//    &quot;Content-type&quot;:&quot;application/x-www-form-urlencoded&quot;</span></span>
<span class="line"><span class="token comment">// }, </span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//       body:{}  直接带对象会有问题  默认是json格式</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">//        const params = new URLSearchParams();</span></span>
<span class="line"><span class="token comment">//        params.append(&#39;param1&#39;, &#39;value1&#39;);</span></span>
<span class="line"><span class="token comment">//        params.append(&#39;param2&#39;, &#39;value2&#39;);</span></span>
<span class="line"><span class="token comment">//        body:params,</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//        或者 </span></span>
<span class="line"><span class="token comment">//        body:&quot;param1=value1&amp;param2=value2&quot;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">这种最好</span>
<span class="line"><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:4000/xuxin&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;Content-type&quot;</span><span class="token operator">:</span><span class="token string">&quot;application/json&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span> </span>
<span class="line">    <span class="token literal-property property">body</span><span class="token operator">:</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&#39;example&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//路径，各项参数</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">rs</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rs<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">后端设置</span>
<span class="line"></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Methods&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Access-Control-Allow-Headers&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">或者 app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="同源策略" tabindex="-1"><a class="header-anchor" href="#同源策略"><span>同源策略</span></a></h2><p>同源策略（Same-Origin Policy）是一种浏览器安全机制，用于限制来自不同源（域名、协议或端口）的网页对当前网页的访问和操作。同源策略的目的是保护用户的隐私和安全，防止恶意网站利用跨域请求来获取敏感信息或执行恶意操作</p><p>同源策略的规则如下：</p><ol><li>协议相同：两个页面的协议必须相同，即都是HTTP或都是HTTPS。</li><li>域名相同：两个页面的域名必须相同，包括子域名。例如，<code>www.example.com和api.example.com被视为不同的域名。</code></li><li>端口相同：两个页面的端口号必须相同。如果未指定端口号，默认为80，HTTPS默认为443。</li></ol><p>如果两个页面不满足上述所有条件，那么它们就被认为是跨域的。在跨域请求中，浏览器会限制访问和操作其他源的资源，防止潜在的安全风险</p><h3 id="处理同源策略" tabindex="-1"><a class="header-anchor" href="#处理同源策略"><span>处理同源策略</span></a></h3><p>要在浏览器中进行跨域请求，可以使用以下方法来绕过同源策略的限制</p><ul><li>跨域资源共享（CORS）：通过服务器设置响应头来允许特定源的跨域请求</li><li>代理服务器：在同一域名下设置一个代理服务器，将跨域请求转发到目标源，并将响应返回给原始页面</li><li>通过JavaScript动态创建的<code>&lt;script&gt;</code>元素加载的跨域脚本（JSONP）是一种绕过同源策略的常见技术</li></ul><h3 id="jsonp" tabindex="-1"><a class="header-anchor" href="#jsonp"><span>JSONP</span></a></h3><p>是一种绕过同源策略的跨域请求技术。它通过动态创建<code>&lt;script&gt;</code>标签来加载包含JSON数据的脚本文件，从而实现跨域请求并获取数据</p><ol><li>发起JSONP请求的网页创建一个全局函数，用于处理返回的数据。通常该函数会作为URL的查询参数传递给目标服务器。</li><li>网页通过动态创建<code>&lt;script&gt;</code>标签，将目标URL设置为脚本的来源，并将全局函数名作为查询参数传递给服务器。</li><li>目标服务器接收到请求后，将数据包装在全局函数中的回调函数中，并返回给网页。服务器返回的数据通过脚本执行，触发全局函数的调用。</li><li>网页中定义的全局函数在脚本执行时被调用，以获取返回的数据。在函数中可以对数据进行处理和使用。</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">function</span> <span class="token function">handleResponse</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 处理返回的数据</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 创建&lt;script&gt;标签并设置src属性</span></span>
<span class="line"><span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;script&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&#39;https://api.example.com/data?callback=handleResponse&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 将&lt;script&gt;标签添加到页面中</span></span>
<span class="line">document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">document<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">   <span class="token keyword">let</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">   dom<span class="token punctuation">.</span>src <span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">http://localhost:3000/bufan</span><span class="token template-punctuation string">\`</span></span></span>
<span class="line">    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">bufan</span><span class="token punctuation">(</span><span class="token parameter">sss</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sss<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// -----------------</span></span>
<span class="line"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">b</span><span class="token operator">:</span><span class="token string">&quot;11&quot;</span><span class="token punctuation">}</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/bufan&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">bufan(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">\`</span></span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="数据含义" tabindex="-1"><a class="header-anchor" href="#数据含义"><span>数据含义</span></a></h2><h3 id="响应头-response-headers" tabindex="-1"><a class="header-anchor" href="#响应头-response-headers"><span>响应头（Response Headers)</span></a></h3><ol><li>Access-Control-Allow-Origin：指定允许访问资源的域名。当进行跨域请求时，服务器可以设置这个字段来控制哪些域名可以访问资源。</li><li>Content-Encoding：指示服务器对响应进行了何种压缩编码。常见的值包括gzip、deflate等。</li><li>Content-Type：指定响应的内容类型及采用的编码方式。例如，Content-Type: application/json;charset=utf-8表示响应内容是JSON格式的数据，编码方式为UTF-8。</li><li>Date：指示服务器响应的日期和时间。</li><li>Server：指示服务器的软件和版本信息。</li><li>Cache-Control：控制客户端缓存页面数据的行为。例如，Cache-Control: no-cache表示客户端不应缓存响应。</li><li>Expires：指定响应的过期时间。客户端可以使用这个字段来判断是否需要重新请求资源。</li><li>Last-Modified：指示资源的最后修改时间。客户端可以使用这个字段来判断资源是否已经发生变化。</li><li>Content-Length：指示响应的内容长度，以字节为单位。</li><li>Set-Cookie：用于在响应中设置Cookie。服务器可以使用这个字段将Cookie信息发送给客户端</li><li>Keep-Alive 是一个HTTP响应头字段，用于指示服务器在完成当前请求后是否保持与客户端的连接活跃。当服务器发送带有 Keep-Alive 头的响应时，它表明服务器愿意继续使用同一TCP连接与客户端进行通信，以便在后续的请求中减少连接建立的开销</li></ol><h3 id="请求头" tabindex="-1"><a class="header-anchor" href="#请求头"><span>请求头</span></a></h3><ol><li>Accept：告诉服务器客户端能够接受的响应内容类型。例如，Accept: application/json表示客户端希望接收JSON格式的响应。</li><li>Accept-Language：告诉服务器客户端偏好的语言。服务器可以根据这个信息返回相应语言的内容。例如，Accept-Language: en-US表示客户端偏好英语（美国）的内容。</li><li>User-Agent：告诉服务器客户端的用户代理信息，即浏览器或应用程序的类型和版本。服务器可以根据这个信息进行浏览器兼容性处理或分析用户使用的客户端。</li><li>Referer（Referrer）：告诉服务器当前请求是从哪个页面链接过来的。这个字段在跟踪和分析用户行为时很有用。</li><li>Authorization：如果需要进行身份验证，该字段用于在请求中发送身份验证凭据，例如令牌或密钥。授权方式可以是基本认证（Basic Authentication）或Bearer令牌（Bearer Token）等。</li><li>Content-Type：在发送包含实体主体的请求（例如POST请求）时，该字段指定了请求主体的媒体类型和编码方式。例如，Content-Type: application/json表示请求主体是JSON格式的数据。</li><li>Cookie：将存储在客户端的Cookie信息发送给服务器。服务器可以使用这些Cookie来识别和跟踪用户的会话状态。</li><li>Cache-Control：指定请求的缓存行为。例如，Cache-Control: no-cache表示客户端不应使用缓存的响应，而应直接从服务器获取最新的数据。</li><li>Origin：在跨域请求中，该字段指示请求的来源域。它用于执行跨域请求时的预检请求（Preflight Request）和服务器的访问控制。</li><li>Accept-Encoding 是一个请求头字段，用于告诉服务器客户端支持的内容编码方式或数据压缩格式</li></ol><h2 id="tcp协议" tabindex="-1"><a class="header-anchor" href="#tcp协议"><span>TCP协议</span></a></h2><p>三次握手</p><ol><li>客服端 向 服务器发送请求链接信息</li><li>服务器接收到请求信息 同意请求 =&gt; 则发送信息给客服端 同意请求</li><li>客服端接收到服务器信息; 再次向服务器发出确认链接信息;</li></ol><p>为什么TCP客户端最后还要发送一次确认?</p><ul><li>​ 主要防止已经失效的连接请求报文突然又传送到了服务器 =&gt; 应为网络延迟问题</li><li>第一次客户端迟迟没有收到确认报文，以为服务器没有收到，此时重新向服务器发送这条报文，此后客户端和服务器经过两次握手完成连接，传输数据，然后关闭连接。此时此前滞留的那一次请求连接，网络通畅了到达了服务器，这个报文本该是失效的，但是，两次握手的机制将会让客户端和服务器再次建立连接，这将导致不必要的错误和资源的浪费。</li></ul><p>开始传输数据 客服端 =&gt; 服务器 服务器=&gt; 客服端</p><p>四次挥手</p><ol><li>客户端 发出信息到服务器,并且停止发送数据并告知数据已传完,</li><li>服务器告诉客户端信息已接收,同时服务器发送信息是否还有数据发送,还有数据传输,客户端依然要接受</li><li>客服端等待 =&gt; 服务器发送数据; 服务器数据发送完毕并告知客服端数据发送完毕</li><li>客服端关闭连接 并告知服务器 =&gt; 关闭连接</li></ol>`,55)])])}const o=s(e,[["render",l]]),u=JSON.parse('{"path":"/javaScript/20-ajax.html","title":"","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"AJAX","slug":"ajax","link":"#ajax","children":[]},{"level":2,"title":"原生请求","slug":"原生请求","link":"#原生请求","children":[{"level":3,"title":"使用","slug":"使用","link":"#使用","children":[]},{"level":3,"title":"携带参数","slug":"携带参数","link":"#携带参数","children":[]},{"level":3,"title":"请求区别","slug":"请求区别","link":"#请求区别","children":[]}]},{"level":2,"title":"状态码","slug":"状态码","link":"#状态码","children":[]},{"level":2,"title":"Axios","slug":"axios","link":"#axios","children":[{"level":3,"title":"基础使用","slug":"基础使用","link":"#基础使用","children":[]}]},{"level":2,"title":"fetch","slug":"fetch","link":"#fetch","children":[]},{"level":2,"title":"同源策略","slug":"同源策略","link":"#同源策略","children":[{"level":3,"title":"处理同源策略","slug":"处理同源策略","link":"#处理同源策略","children":[]},{"level":3,"title":"JSONP","slug":"jsonp","link":"#jsonp","children":[]}]},{"level":2,"title":"数据含义","slug":"数据含义","link":"#数据含义","children":[{"level":3,"title":"响应头（Response Headers)","slug":"响应头-response-headers","link":"#响应头-response-headers","children":[]},{"level":3,"title":"请求头","slug":"请求头","link":"#请求头","children":[]}]},{"level":2,"title":"TCP协议","slug":"tcp协议","link":"#tcp协议","children":[]}],"git":{},"filePathRelative":"javaScript/20-ajax.md"}');export{o as comp,u as data};
