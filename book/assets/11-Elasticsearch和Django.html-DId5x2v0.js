import{_ as s,c as a,a as p,o as t}from"./app-BtRpJXvK.js";const e={};function l(c,n){return t(),a("div",null,[...n[0]||(n[0]=[p(`<h2 id="django" tabindex="-1"><a class="header-anchor" href="#django"><span>django</span></a></h2><p>注意: 之前已经学习过了, 所有一些关于Django的内容就不会怎么去讲解, 只告诉你是怎么使用的, 如果忘记了, 可以看一下之前的课程,</p><h3 id="基础安装" tabindex="-1"><a class="header-anchor" href="#基础安装"><span>基础安装</span></a></h3><blockquote><p>pip install django==4.2</p></blockquote><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 如何让计算机能够正常运行启动django项目</span></span>
<span class="line"><span class="token number">1.</span>计算机名称不能有中文</span>
<span class="line"><span class="token number">2.</span>项目文件夹路径也最好不要有中文</span>
<span class="line"><span class="token number">3.</span>一个pycharm窗口也只开一个django项目</span>
<span class="line"><span class="token number">4.</span>不能运行单个的py文件</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="创建项目" tabindex="-1"><a class="header-anchor" href="#创建项目"><span>创建项目</span></a></h3><blockquote><p>通过指令操作, 或者通过pycharm编辑器操作</p></blockquote><ol><li><p>django-admin startproject 项目名</p></li><li><p>创建app模块--&gt;功能</p><ul><li><p>切换到manage.py同级目录下操作</p></li><li><p>执行命令:python manage.py startapp 应用名</p></li><li><p>注册应用:</p><ul><li><p>在项目同名字的文件夹中的settings.py文件中进行注册</p></li><li><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 在项目同名字的文件夹中的settings.py文件中进行注册:</span></span>
<span class="line">INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.admin&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.auth&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.contenttypes&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.sessions&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.messages&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.staticfiles&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token comment"># 直接以字符串的形式写入</span></span>
<span class="line">    <span class="token string">&#39;fangzu&#39;</span>  </span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul></li><li><p>python manage.py runserver 启动项目</p><ul><li>ctrl+c 停止项目运行</li></ul></li></ol><h3 id="项目介绍" tabindex="-1"><a class="header-anchor" href="#项目介绍"><span>项目介绍</span></a></h3><ul><li>mysite项目文件夹 <ul><li>mysite项目同名文件夹 <ul><li><code>asgi.py</code> 兼容文件</li><li>settings.py 配置文件</li><li>urls.py 路由与视图对应关系</li><li>wsgi.py wsgiref 模块使用(不考虑)</li></ul></li><li>manage.py文件 dajngo的入口文件</li><li>app01应用文件夹 <ul><li>admin.py django后台管理</li><li>apps.py 注册应用使用</li><li>models.py 数据库相关的模型类(orm)</li><li>tests.py 测试文件</li><li>views.py 视图层</li><li>migrations 文件夹:数据库迁移记录</li><li><code>templates</code> 存放html文件夹</li></ul></li></ul></li></ul><h3 id="视图映射" tabindex="-1"><a class="header-anchor" href="#视图映射"><span>视图映射</span></a></h3><ul><li><code>HttpResponse</code> 返回数据</li><li><code>render</code> 返回html <ul><li><code>render(request, 模版名称, context = { 携带数据 })</code></li></ul></li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 视图文件polls中的views.py文件   </span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 获取django.shortcuts库中 HttpResponse 返回数据API</span></span>
<span class="line"><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span>HttpResponse</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建get请求函数 通过HttpResponse返回数据,  接口函数默认接受request数据(前端携带数据)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">book_info_msg</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">	<span class="token comment"># get传递数据</span></span>
<span class="line">    book_id <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 返回数据</span></span>
<span class="line">    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;你查找的图书id是: </span><span class="token interpolation"><span class="token punctuation">{</span>book_id<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span> <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建动态路由携带数据方式</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">book_info_post</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> book_id<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;你查找的图书id是: </span><span class="token interpolation"><span class="token punctuation">{</span>book_id<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span> <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ------------------------------------------------------------</span></span>
<span class="line"><span class="token comment"># 主文件夹中下的urls.py文件中设置 引入polls文件夹下的所有内容函数</span></span>
<span class="line"><span class="token keyword">from</span> polls <span class="token keyword">import</span> views</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 项目路由设置: path可匹配任意请求</span></span>
<span class="line">urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    path<span class="token punctuation">(</span><span class="token string">&#39;admin/&#39;</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># 请求携带数据 http://127.0.0.1:8000/book?id=23</span></span>
<span class="line">    path<span class="token punctuation">(</span><span class="token string">&#39;book&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>book_info_msg<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># 请求携带数据(动态路由)  http://127.0.0.1:8000/books/3</span></span>
<span class="line">    path<span class="token punctuation">(</span><span class="token string">&#39;books/&lt;book_id&gt;&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>book_info_post<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="模版文件" tabindex="-1"><a class="header-anchor" href="#模版文件"><span>模版文件</span></a></h3><ul><li><p>在项目根目录创建 templates 文件夹</p></li><li><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 或者在应用目录中创建</span></span>
<span class="line"><span class="token comment"># python manage.py startapp home</span></span>
<span class="line"><span class="token comment"># mkdir home/templates</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><blockquote><p>模版文件配置<code>DIRS</code></p></blockquote><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 渲染模版信息配置</span></span>
<span class="line">TEMPLATES <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&#39;BACKEND&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;django.template.backends.django.DjangoTemplates&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;DIRS&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></span>
<span class="line">            BASE_DIR <span class="token operator">/</span> <span class="token string">&#39;templates&#39;</span><span class="token punctuation">,</span>  <span class="token comment"># 添加项目级模板目录</span></span>
<span class="line">        <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;APP_DIRS&#39;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span>  <span class="token comment"># 允许从应用目录加载模板</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>注意: 在Django模板中，变量名不能以下划线开头，这是为了防止访问私有属性。</p></blockquote><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 模版中使用传递的数据</span></span>
<span class="line"><span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token builtin">list</span><span class="token number">.1</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> obj<span class="token punctuation">.</span>ceshi <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 与ejs一样可以书写任意python基础代码</span></span>
<span class="line"><span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token operator">%</span>  <span class="token operator">%</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 循环</span></span>
<span class="line"><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">for</span> foo <span class="token keyword">in</span> tuple1 <span class="token operator">%</span><span class="token punctuation">}</span></span>
<span class="line">	<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> forloop <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span></span>
<span class="line"><span class="token punctuation">{</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 条件判断</span></span>
<span class="line"><span class="token punctuation">{</span><span class="token operator">%</span><span class="token keyword">if</span> 条件<span class="token operator">%</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>这是<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line"><span class="token punctuation">{</span><span class="token operator">%</span><span class="token keyword">elif</span> 条件<span class="token operator">%</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>这是<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line"><span class="token punctuation">{</span><span class="token operator">%</span><span class="token keyword">else</span><span class="token operator">%</span><span class="token punctuation">}</span></span>
<span class="line">    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>这是<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line"><span class="token punctuation">{</span><span class="token operator">%</span> endif <span class="token operator">%</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="案例" tabindex="-1"><a class="header-anchor" href="#案例"><span>案例</span></a></h3><blockquote><p>在Django创建的模块应用文件</p></blockquote><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># one模块总的views文件</span></span>
<span class="line"><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span> HttpResponse</span>
<span class="line"><span class="token keyword">from</span> one<span class="token punctuation">.</span>models <span class="token keyword">import</span> EsAction</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 引入主文件</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">show_home</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&#39;index_demo.html&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 跳转到返回的数据文件</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">show_home_search</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    args <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;args&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    page <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> args<span class="token punctuation">:</span></span>
<span class="line">        es <span class="token operator">=</span> EsAction<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        query <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">&quot;query&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token string">&quot;match_all&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">                <span class="token comment"># &quot;match&quot;: {</span></span>
<span class="line">                <span class="token comment">#     &quot;title&quot;: args</span></span>
<span class="line">                <span class="token comment"># }</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">&quot;from&quot;</span><span class="token punctuation">:</span> page<span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">&quot;size&quot;</span><span class="token punctuation">:</span> <span class="token number">5</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        result <span class="token operator">=</span> es<span class="token punctuation">.</span>es_action_search<span class="token punctuation">(</span>query<span class="token punctuation">)</span></span>
<span class="line">        result <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">&#39;hits&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;hits&#39;</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token comment"># 处理数据结构</span></span>
<span class="line">        new_list_new <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token keyword">for</span> i <span class="token keyword">in</span> result<span class="token punctuation">:</span></span>
<span class="line">            new_list_new<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">                <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> i<span class="token punctuation">[</span><span class="token string">&#39;_source&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;title&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token string">&quot;title_url&quot;</span><span class="token punctuation">:</span> i<span class="token punctuation">[</span><span class="token string">&#39;_source&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;title_url&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token string">&quot;price&quot;</span><span class="token punctuation">:</span> i<span class="token punctuation">[</span><span class="token string">&#39;_source&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&#39;price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        next_page <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span></span>
<span class="line">        pre_page <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0</span></span>
<span class="line">        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&#39;list_demo.html&#39;</span><span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">&quot;result&quot;</span><span class="token punctuation">:</span> new_list_new<span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">&quot;args&quot;</span><span class="token punctuation">:</span> args<span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">&quot;next_page&quot;</span><span class="token punctuation">:</span> next_page<span class="token punctuation">,</span></span>
<span class="line">            <span class="token string">&quot;pre_page&quot;</span><span class="token punctuation">:</span> pre_page</span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&#39;list_demo.html&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># modules</span></span>
<span class="line"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models</span>
<span class="line"><span class="token keyword">from</span> elasticsearch <span class="token keyword">import</span> Elasticsearch</span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">EsAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        self<span class="token punctuation">.</span>es <span class="token operator">=</span> Elasticsearch<span class="token punctuation">(</span><span class="token string">&quot;http://localhost:9200&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">if</span> self<span class="token punctuation">.</span>es<span class="token punctuation">.</span>ping<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Elasticsearch OK&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Elasticsearch Error&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">def</span> <span class="token function">es_action_search</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> query<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>es<span class="token punctuation">.</span>search<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">&quot;es_index&quot;</span><span class="token punctuation">,</span> body<span class="token operator">=</span>query<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code><span class="line"><span class="token comment">&lt;!-- 模块中templates的html文件 --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">margin-top</span><span class="token punctuation">:</span> 15%</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>数据搜索<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/home/search<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>get<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>args<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>搜寻<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>365px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> 50px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">/&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span>  <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Search<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">height</span><span class="token punctuation">:</span> 56px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">/&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">&lt;!-- 模块中templates的html文件 --&gt;</span></span>
<span class="line"><span class="token comment">&lt;!-- 列表文件 --&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">align</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    {% for i in result %}</span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>60%<span class="token punctuation">;</span><span class="token property">margin-top</span><span class="token punctuation">:</span>1%<span class="token punctuation">;</span><span class="token property">padding</span><span class="token punctuation">:</span>1%<span class="token punctuation">;</span><span class="token property">text-align</span><span class="token punctuation">:</span>left<span class="token punctuation">;</span><span class="token property">border</span><span class="token punctuation">:</span> 1px solid #b2dba1</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>房子标题：{{i.title}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>房子价格：{{i.price}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>房子地址: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>_blank<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{i.title_url}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>地址<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    {% endfor %}</span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span>200px<span class="token punctuation">;</span> <span class="token property">margin</span><span class="token punctuation">:</span>20px auto </span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>?args={{args}}&amp;page={{pre_page}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>上一页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span> <span class="token entity named-entity" title=" ">&amp;nbsp;</span></span>
<span class="line">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>?args={{args}}&amp;page={{next_page}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>下一页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="django配置内容" tabindex="-1"><a class="header-anchor" href="#django配置内容"><span>Django配置内容</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin</span>
<span class="line"><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path</span>
<span class="line"><span class="token keyword">from</span> one <span class="token keyword">import</span> views</span>
<span class="line"></span>
<span class="line">urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    path<span class="token punctuation">(</span><span class="token string">&#39;admin/&#39;</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    path<span class="token punctuation">(</span><span class="token string">&#39;home/&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>show_home<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    path<span class="token punctuation">(</span><span class="token string">&#39;home/search&#39;</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>show_home_search<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># settings.py</span></span>
<span class="line">INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.admin&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.auth&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.contenttypes&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.sessions&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.messages&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;django.contrib.staticfiles&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string">&#39;模块应用名称&#39;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">TEMPLATES <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&#39;BACKEND&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;django.template.backends.django.DjangoTemplates&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token comment"># 这里要进行模版应用设置</span></span>
<span class="line">        <span class="token string">&#39;DIRS&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></span>
<span class="line">            BASE_DIR <span class="token operator">/</span> <span class="token string">&#39;templates&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;APP_DIRS&#39;</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;OPTIONS&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token string">&#39;context_processors&#39;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></span>
<span class="line">                <span class="token string">&#39;django.template.context_processors.debug&#39;</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token string">&#39;django.template.context_processors.request&#39;</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token string">&#39;django.contrib.auth.context_processors.auth&#39;</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token string">&#39;django.contrib.messages.context_processors.messages&#39;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,26)])])}const i=s(e,[["render",l]]),u=JSON.parse('{"path":"/spider/11-Elasticsearch%E5%92%8CDjango.html","title":"","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"django","slug":"django","link":"#django","children":[{"level":3,"title":"基础安装","slug":"基础安装","link":"#基础安装","children":[]},{"level":3,"title":"创建项目","slug":"创建项目","link":"#创建项目","children":[]},{"level":3,"title":"项目介绍","slug":"项目介绍","link":"#项目介绍","children":[]},{"level":3,"title":"视图映射","slug":"视图映射","link":"#视图映射","children":[]},{"level":3,"title":"模版文件","slug":"模版文件","link":"#模版文件","children":[]},{"level":3,"title":"案例","slug":"案例","link":"#案例","children":[]},{"level":3,"title":"Django配置内容","slug":"django配置内容","link":"#django配置内容","children":[]}]}],"git":{},"filePathRelative":"spider/11-Elasticsearch和Django.md"}');export{i as comp,u as data};
