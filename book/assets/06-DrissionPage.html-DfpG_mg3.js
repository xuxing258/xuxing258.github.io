import{_ as s,c as a,a as p,o as t}from"./app-oYpRxrJy.js";const e={};function l(c,n){return t(),a("div",null,[...n[0]||(n[0]=[p(`<h2 id="drissionpage" tabindex="-1"><a class="header-anchor" href="#drissionpage"><span>DrissionPage</span></a></h2><p>DrissionPage 是一个基于 Python 的网页自动化库，结合了 <strong>Selenium</strong> 的浏览器控制能力和 <strong>requests</strong> 的高效网络请求功能，适用于爬虫、自动化测试和 RPA（机器人流程自动化）</p><blockquote><p>安装: <code>pip install DrissionPage </code> 安装对应第三方模块</p></blockquote><h2 id="基础使用" tabindex="-1"><a class="header-anchor" href="#基础使用"><span>基础使用</span></a></h2><h3 id="基础属性与方法" tabindex="-1"><a class="header-anchor" href="#基础属性与方法"><span>基础属性与方法</span></a></h3><ul><li>标签对象.html属性: 获取当前页面的html源码</li><li>标签对象.title属性: 获取网页的title标签内容</li><li>标签对象.url属性: 获取网页的url信息</li><li>browser.quit(): 关闭浏览器</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># Chromium用于控制浏览器页面对象 </span></span>
<span class="line"><span class="token keyword">from</span> DrissionPage <span class="token keyword">import</span> Chromium</span>
<span class="line"><span class="token comment"># 连接浏览器</span></span>
<span class="line">browser <span class="token operator">=</span> Chromium<span class="token punctuation">(</span><span class="token punctuation">)</span>  </span>
<span class="line"><span class="token comment"># 获取最新标签页对象</span></span>
<span class="line">tab <span class="token operator">=</span> browser<span class="token punctuation">.</span>latest_tab  </span>
<span class="line"><span class="token comment"># 访问网页</span></span>
<span class="line">tab<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;https://www.baidu.com&#39;</span><span class="token punctuation">)</span>  </span>
<span class="line"><span class="token comment"># 获取当前页面的html源码</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>tab<span class="token punctuation">.</span>html<span class="token punctuation">)</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="标签页管理" tabindex="-1"><a class="header-anchor" href="#标签页管理"><span>标签页管理</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 标签页一 tab</span></span>
<span class="line">tab <span class="token operator">=</span> browser<span class="token punctuation">.</span>latest_tab  </span>
<span class="line">tab<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;https://www.baidu.com&#39;</span><span class="token punctuation">)</span>  </span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>tab<span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token comment"># 获取网页的标题</span></span>
<span class="line">time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 标签页 新建一个标签页并访问网址tab2网页</span></span>
<span class="line">tab2 <span class="token operator">=</span> browser<span class="token punctuation">.</span>new_tab<span class="token punctuation">(</span><span class="token string">&#39;https://www.taob.com&#39;</span><span class="token punctuation">)</span> </span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>tab2<span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token comment"># 获取网页的标题</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>管理单个页面的历史记录</p></blockquote><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">browser <span class="token operator">=</span> Chromium<span class="token punctuation">(</span><span class="token punctuation">)</span> </span>
<span class="line">tab <span class="token operator">=</span> browser<span class="token punctuation">.</span>latest_tab  </span>
<span class="line">tab<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;https://www.baidu.com/&#39;</span><span class="token punctuation">)</span></span>
<span class="line">time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">tab<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;https://www.taobao.com/&#39;</span><span class="token punctuation">)</span></span>
<span class="line">time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">tab<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&#39;https://www.jd.com/&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">tab<span class="token punctuation">.</span>back<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># 后退</span></span>
<span class="line">time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">)</span></span>
<span class="line">tab<span class="token punctuation">.</span>forward<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 前进</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="浏览器配置" tabindex="-1"><a class="header-anchor" href="#浏览器配置"><span>浏览器配置</span></a></h3><ul><li><code>set_paths(browser_path,local_port,user_data_path)</code><ul><li>browser_path: 浏览器可执行文件路径</li><li>local_port: 浏览器要使用的本地端口号</li><li>download_path: 下载文件默认保存路径</li><li>user_data_path: 用户数据文件夹路径</li></ul></li><li><code>co1.set_timeouts(10, 10, 10)</code> 用于设置几种超时时间，单位为秒。 <ul><li><code>&#39;base&#39;</code>： 默认值None, 超时时间，用于元素等待</li><li><code>&#39;page_load&#39;</code>： 默认值None 页面加载超时时间</li><li><code>&#39;script&#39;</code>： 默认值None JavaScript 运行超时时间</li></ul></li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment">#  ChromiumOptions设置配置信息</span></span>
<span class="line"><span class="token keyword">from</span> DrissionPage <span class="token keyword">import</span> Chromium<span class="token punctuation">,</span>ChromiumOptions</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 创建多个配置对象，每个指定不同的端口号和用户文件夹路径</span></span>
<span class="line">co1 <span class="token operator">=</span> ChromiumOptions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_paths<span class="token punctuation">(</span>local_port<span class="token operator">=</span><span class="token number">9111</span><span class="token punctuation">,</span> user_data_path<span class="token operator">=</span><span class="token string">r&#39;D:\\data1&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># 无头模式 不显示浏览器</span></span>
<span class="line">co<span class="token punctuation">.</span>headless<span class="token punctuation">(</span><span class="token punctuation">)</span>  	</span>
<span class="line"><span class="token comment"># 设置浏览器最大显示</span></span>
<span class="line">co<span class="token punctuation">.</span>set_argument<span class="token punctuation">(</span><span class="token string">&#39;--start-maximized&#39;</span><span class="token punctuation">)</span> 	</span>
<span class="line"><span class="token comment"># 匿名模式 浏览器无痕模式</span></span>
<span class="line">co<span class="token punctuation">.</span>incognito<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># 无沙盒模式  在liunx系统中需要设置</span></span>
<span class="line">co1<span class="token punctuation">.</span>set_argument<span class="token punctuation">(</span><span class="token string">&#39;--no-sandbox&#39;</span><span class="token punctuation">)</span>  </span>
<span class="line"><span class="token comment"># 禁用 GPU 加速，通常用于解决一些图形相关的问题</span></span>
<span class="line">co1<span class="token punctuation">.</span>set_argument<span class="token punctuation">(</span><span class="token string">&quot;--disable-gpu&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">#  设置页面加载超时、脚本超时和网络超时的时间为 10 秒</span></span>
<span class="line">co1<span class="token punctuation">.</span>set_timeouts<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 以该配置创建浏览器页面对象</span></span>
<span class="line">page <span class="token operator">=</span> Chromium<span class="token punctuation">(</span>co1<span class="token punctuation">)</span><span class="token punctuation">.</span>latest_tab</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="元素" tabindex="-1"><a class="header-anchor" href="#元素"><span>元素</span></a></h2><ul><li><code>ele </code> 用于查找其内部第一个符合条件的元素 <ul><li>timeout 等待元素出现的超时时间(秒)</li></ul></li><li><code>eles</code> 此方法与<code>ele()</code>相似，但返回的是匹配到的所有元素组成的列表 <ul><li>timeout 等待元素出现的超时时间(秒)</li></ul></li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">text_input <span class="token operator">=</span> page<span class="token punctuation">.</span>ele<span class="token punctuation">(</span><span class="token string">&quot;#key&quot;</span><span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># id选择器  超过2秒未返回None</span></span>
<span class="line"></span>
<span class="line">text_input <span class="token operator">=</span> page<span class="token punctuation">.</span>ele<span class="token punctuation">(</span><span class="token string">&#39;xpath://*[@id=&quot;key&quot;]&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># xpath 方式查找元素</span></span>
<span class="line"> </span>
<span class="line">ele <span class="token operator">=</span> tab<span class="token punctuation">.</span>ele<span class="token punctuation">(</span><span class="token string">&#39;css:#s-top-left&gt;a&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 用selector 方式查找元素</span></span>
<span class="line">ele <span class="token operator">=</span> tab<span class="token punctuation">.</span>eles<span class="token punctuation">(</span><span class="token string">&#39;css:#s-top-left&gt;a&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 用selector 方式查找元素</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>ele<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token comment">#获取元素文本内容</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th style="text-align:center;">原写法</th><th style="text-align:center;">简化写法</th><th style="text-align:center;">说明</th></tr></thead><tbody><tr><td style="text-align:center;"><code>@id</code></td><td style="text-align:center;"><code>#</code></td><td style="text-align:center;">表示 id 属性，简化写法只在语句最前面且单独使用时生效</td></tr><tr><td style="text-align:center;"><code>@class</code></td><td style="text-align:center;"><code>.</code></td><td style="text-align:center;">表示 class 属性，简化写法只在语句最前面且单独使用时生效</td></tr><tr><td style="text-align:center;"><code>text</code></td><td style="text-align:center;"><code>tx</code></td><td style="text-align:center;">按文本匹配</td></tr><tr><td style="text-align:center;"><code>@text()</code></td><td style="text-align:center;"><code>@tx()</code></td><td style="text-align:center;">按文本查找，与 @ 或 @@ 配合使用时</td></tr><tr><td style="text-align:center;"><code>tag</code></td><td style="text-align:center;"><code>t</code></td><td style="text-align:center;">按标签类型匹配</td></tr><tr><td style="text-align:center;"><code>@tag()</code></td><td style="text-align:center;"><code>@t()</code></td><td style="text-align:center;">按元素名查找，与 @ 或 @@ 配合使用时</td></tr><tr><td style="text-align:center;"><code>xpath</code></td><td style="text-align:center;"><code>x</code></td><td style="text-align:center;">用 xpath 方式查找元素</td></tr><tr><td style="text-align:center;"><code>css</code></td><td style="text-align:center;"><code>c</code></td><td style="text-align:center;">用 css selector 方式查找元素</td></tr></tbody></table><h3 id="获取元素内容和属性" tabindex="-1"><a class="header-anchor" href="#获取元素内容和属性"><span>获取元素内容和属性</span></a></h3><ul><li><code>tag</code> 此属性返回元素的标签名</li><li><code>text </code> 此属性返回元素内所有文本组合成的字符串</li><li><code>link </code> 此方法返回元素的href属性或src属性，没有这两个属性则返回None</li><li><code>attr</code> 此方法返回元素某个 attribute 属性值</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>ele<span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token comment">#获取元素文本内容</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>ele<span class="token punctuation">.</span>attr<span class="token punctuation">(</span><span class="token string">&quot;href&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#获取元素属性</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">eles <span class="token operator">=</span> page<span class="token punctuation">(</span><span class="token string">&#39;#s-top-left&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>eles<span class="token punctuation">(</span><span class="token string">&#39;t:a&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>eles<span class="token punctuation">.</span>get<span class="token punctuation">.</span>texts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 获取所有元素的文本</span></span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>eles<span class="token punctuation">.</span>get<span class="token punctuation">.</span>links<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 获取所有元素的href属性或src属性</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="等待" tabindex="-1"><a class="header-anchor" href="#等待"><span>等待</span></a></h3><blockquote><p>page.wait.eles_loaded(选择, timeout=秒)</p></blockquote><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line">ele1<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 点击某个元素</span></span>
<span class="line">page<span class="token punctuation">.</span>wait<span class="token punctuation">.</span>eles_loaded<span class="token punctuation">(</span><span class="token string">&#39;#div1&#39;</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 等待 id 为 div1 的元素加载</span></span>
<span class="line">ele2<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># div1 加载完成后再执行下一步操作</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="交互元素" tabindex="-1"><a class="header-anchor" href="#交互元素"><span>交互元素</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 引入按键交互  </span></span>
<span class="line"><span class="token keyword">from</span> DrissionPage<span class="token punctuation">.</span>common <span class="token keyword">import</span> Keys</span>
<span class="line"><span class="token comment"># 输入内容</span></span>
<span class="line">text_input<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;美食&quot;</span><span class="token punctuation">)</span></span>
<span class="line">text_input<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>ENTER<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 回车触发</span></span>
<span class="line">time<span class="token punctuation">.</span>seep<span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">)</span></span>
<span class="line">text_input<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#清空内容</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 进行下拉到底部</span></span>
<span class="line">page<span class="token punctuation">.</span>scroll<span class="token punctuation">.</span>to_bottom<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># 等待2s</span></span>
<span class="line">time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># 进行下拉到底部</span></span>
<span class="line">page<span class="token punctuation">.</span>scroll<span class="token punctuation">.</span>to_bottom<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># 获取网页源码</span></span>
<span class="line">msg_data <span class="token operator">=</span> page<span class="token punctuation">.</span>html</span>
<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span>msg_data<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="处理数据" tabindex="-1"><a class="header-anchor" href="#处理数据"><span>处理数据</span></a></h4><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 获取网页源码 转换成lxml数据</span></span>
<span class="line">dom_msg <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>page<span class="token punctuation">.</span>html<span class="token punctuation">,</span> <span class="token string">&quot;lxml&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># 获取对应的对应</span></span>
<span class="line">msg <span class="token operator">=</span> dom_msg<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;.gl-warp .gl-item .gl-i-wrap&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> msg<span class="token punctuation">:</span></span>
<span class="line">    title <span class="token operator">=</span> i<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;.p-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    shopsName <span class="token operator">=</span> i<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;.p-shop .curr-shop&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    price <span class="token operator">=</span> i<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;.p-price&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    price <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r&#39;\\s+&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;-&#39;</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;./12.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>title<span class="token punctuation">}</span></span><span class="token string">\\n</span><span class="token interpolation"><span class="token punctuation">{</span>shopsName<span class="token punctuation">}</span></span><span class="token string">\\n</span><span class="token interpolation"><span class="token punctuation">{</span>price<span class="token punctuation">}</span></span><span class="token string">\\n=========================\\n&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="点击" tabindex="-1"><a class="header-anchor" href="#点击"><span>点击</span></a></h4><blockquote><p><code>click()</code>和<code>click.left()</code>用于左键点击元素。可选择模拟点击或 js 点击</p></blockquote><table><thead><tr><th style="text-align:center;">参数名称</th><th style="text-align:center;">类型</th><th style="text-align:center;">默认值</th><th>说明</th></tr></thead><tbody><tr><td style="text-align:center;"><code>by_js</code></td><td style="text-align:center;"><code>bool</code></td><td style="text-align:center;"><code>False</code></td><td>指定点击行为方式。 为<code>None</code>时，如不被遮挡，用模拟点击，否则用 js 点击 为<code>True</code>时直接用 js 点击； 为<code>False</code>时强制模拟点击，被遮挡也会进行点击</td></tr><tr><td style="text-align:center;"><code>timeout</code></td><td style="text-align:center;"><code>float</code></td><td style="text-align:center;"><code>1.5</code></td><td>模拟点击的超时时间（秒），等待元素可见、可用、进入视口</td></tr><tr><td style="text-align:center;"><code>wait_stop</code></td><td style="text-align:center;"><code>bool</code></td><td style="text-align:center;"><code>True</code></td><td>点击前是否等待元素停止运动</td></tr></tbody></table><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># 获取点击元素</span></span>
<span class="line">but_page <span class="token operator">=</span> page<span class="token punctuation">.</span>ele<span class="token punctuation">(</span><span class="token string">&#39;xpath://&#39;</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment"># 进行点击</span></span>
<span class="line">next_page<span class="token punctuation">.</span>click<span class="token punctuation">.</span>left<span class="token punctuation">(</span>by_js<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="京东案例" tabindex="-1"><a class="header-anchor" href="#京东案例"><span>京东案例</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> DrissionPage <span class="token keyword">import</span> Chromium<span class="token punctuation">,</span> ChromiumOptions</span>
<span class="line"><span class="token keyword">from</span> DrissionPage<span class="token punctuation">.</span>common <span class="token keyword">import</span> Keys</span>
<span class="line"><span class="token keyword">from</span> DrissionPage<span class="token punctuation">.</span>errors <span class="token keyword">import</span> <span class="token operator">*</span></span>
<span class="line"><span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup</span>
<span class="line"><span class="token keyword">import</span> time<span class="token punctuation">,</span>re<span class="token punctuation">,</span>sys</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 设置网络爬虫</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">spider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># 设置浏览器配置信息信息</span></span>
<span class="line">    co1 <span class="token operator">=</span> ChromiumOptions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_paths<span class="token punctuation">(</span>local_port<span class="token operator">=</span><span class="token number">9111</span><span class="token punctuation">,</span> user_data_path<span class="token operator">=</span>userData<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 无沙盒模式</span></span>
<span class="line">    co1<span class="token punctuation">.</span>set_argument<span class="token punctuation">(</span><span class="token string">&#39;--no-sandbox&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 禁用 GPU 加速，通常用于解决一些图形相关的问题</span></span>
<span class="line">    co1<span class="token punctuation">.</span>set_argument<span class="token punctuation">(</span><span class="token string">&quot;--disable-gpu&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#  设置页面加载超时、脚本超时和网络超时的时间为 10 秒</span></span>
<span class="line">    co1<span class="token punctuation">.</span>set_timeouts<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 以该配置创建浏览器页面对象</span></span>
<span class="line">    page <span class="token operator">=</span> Chromium<span class="token punctuation">(</span>co1<span class="token punctuation">)</span><span class="token punctuation">.</span>latest_tab</span>
<span class="line">    <span class="token comment"># 打开对应路径页面</span></span>
<span class="line">    page<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> page</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 获取元素并输入内容</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">createSpider</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># text_input = page.ele(&quot;#key&quot;)</span></span>
<span class="line">    text_input <span class="token operator">=</span> page<span class="token punctuation">.</span>ele<span class="token punctuation">(</span><span class="token string">&#39;xpath://*[@id=&quot;key&quot;]&#39;</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span></span>
<span class="line">    text_input<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;美食&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    text_input<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>ENTER<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 获取网页的数据</span></span>
<span class="line">    getDataMsg<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">getDataMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    page_index <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line">    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># 进行下拉到底部</span></span>
<span class="line">        page<span class="token punctuation">.</span>scroll<span class="token punctuation">.</span>to_bottom<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># 等待2s</span></span>
<span class="line">        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># 进行下拉到底部</span></span>
<span class="line">        page<span class="token punctuation">.</span>scroll<span class="token punctuation">.</span>to_bottom<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># 等待2s</span></span>
<span class="line">        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span></span>
<span class="line">        hanlerData<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">try</span><span class="token punctuation">:</span></span>
<span class="line">            bol <span class="token operator">=</span> page<span class="token punctuation">.</span>ele<span class="token punctuation">(</span><span class="token string">&#39;xpath://*[@id=&quot;J_bottomPage&quot;]//a[@class=&quot;disabled&quot;]&#39;</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token keyword">not</span> bol<span class="token punctuation">:</span></span>
<span class="line">               but_page <span class="token operator">=</span> page<span class="token punctuation">.</span>ele<span class="token punctuation">(</span><span class="token string">&#39;xpath://*[@id=&quot;J_bottomPage&quot;]//a[@class=&quot;pn-next&quot;]&#39;</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span></span>
<span class="line">               but_page<span class="token punctuation">.</span>click<span class="token punctuation">.</span>left<span class="token punctuation">(</span>by_js<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="line">                sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">except</span> ElementNotFoundError <span class="token keyword">as</span> e<span class="token punctuation">:</span></span>
<span class="line">            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># 传0表示正常退出 1-127为非正常</span></span>
<span class="line">    page_index <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 处理数据</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">hanlerData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token comment"># 获取网页源码 转换成lxml数据</span></span>
<span class="line">    dom_msg <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>page<span class="token punctuation">.</span>html<span class="token punctuation">,</span> <span class="token string">&quot;lxml&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 获取对应的对应</span></span>
<span class="line">    msg <span class="token operator">=</span> dom_msg<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;.gl-warp .gl-item .gl-i-wrap&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> msg<span class="token punctuation">:</span></span>
<span class="line">        title <span class="token operator">=</span> i<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;.p-name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        shopsName <span class="token operator">=</span> i<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;.p-shop .curr-shop&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        price <span class="token operator">=</span> i<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;.p-price&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        price <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">r&#39;\\s+&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;-&#39;</span><span class="token punctuation">,</span> price<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;./12.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;</span><span class="token interpolation"><span class="token punctuation">{</span>title<span class="token punctuation">}</span></span><span class="token string">\\n</span><span class="token interpolation"><span class="token punctuation">{</span>shopsName<span class="token punctuation">}</span></span><span class="token string">\\n</span><span class="token interpolation"><span class="token punctuation">{</span>price<span class="token punctuation">}</span></span><span class="token string">\\n=========================\\n&#39;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span></span>
<span class="line">    url <span class="token operator">=</span> <span class="token string">&quot;https://www.jd.com&quot;</span></span>
<span class="line">    userData <span class="token operator">=</span> <span class="token string">r&#39;C:/Users/15116/Desktop/31-async与await和本地存储/drissionPage_msg/data&#39;</span></span>
<span class="line">    page <span class="token operator">=</span> spider<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    createSpider<span class="token punctuation">(</span>page<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="滑块验证案例" tabindex="-1"><a class="header-anchor" href="#滑块验证案例"><span>滑块验证案例</span></a></h2><p>云码平台: <code>https://console.jfbym.com/own/index/index.html</code></p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">from</span> DrissionPage <span class="token keyword">import</span> Chromium<span class="token punctuation">,</span> ChromiumOptions</span>
<span class="line"><span class="token keyword">from</span> DrissionPage<span class="token punctuation">.</span>common <span class="token keyword">import</span> Actions</span>
<span class="line"><span class="token keyword">import</span> time<span class="token punctuation">,</span> json</span>
<span class="line"><span class="token keyword">import</span> base64</span>
<span class="line"><span class="token keyword">import</span> requests</span>
<span class="line"><span class="token keyword">from</span> jsonpath <span class="token keyword">import</span> jsonpath</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 设置打开浏览器 并且设置默认值</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">setSpider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    co1 <span class="token operator">=</span> ChromiumOptions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>set_paths<span class="token punctuation">(</span>local_port<span class="token operator">=</span><span class="token string">&quot;9333&quot;</span><span class="token punctuation">,</span> user_data_path<span class="token operator">=</span>userData<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment"># 无沙盒模式</span></span>
<span class="line">    co1<span class="token punctuation">.</span>set_argument<span class="token punctuation">(</span><span class="token string">&#39;--no-sandbox&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 禁用 GPU 加速，通常用于解决一些图形相关的问题</span></span>
<span class="line">    co1<span class="token punctuation">.</span>set_argument<span class="token punctuation">(</span><span class="token string">&quot;--disable-gpu&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">#  设置页面加载超时、脚本超时和网络超时的时间为 10 秒</span></span>
<span class="line">    co1<span class="token punctuation">.</span>set_timeouts<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 以该配置创建浏览器页面对象</span></span>
<span class="line">    page <span class="token operator">=</span> Chromium<span class="token punctuation">(</span>addr_or_opts<span class="token operator">=</span>co1<span class="token punctuation">)</span><span class="token punctuation">.</span>latest_tab</span>
<span class="line">    spider_msg<span class="token punctuation">(</span>page<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">spider_msg</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    page<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 选择对应元素</span></span>
<span class="line">    but_click <span class="token operator">=</span> page<span class="token punctuation">.</span>ele<span class="token punctuation">(</span><span class="token string">&#39;xpath://*[@id=&quot;app&quot;]/div/div[1]/div/div/div[1]/span[2]&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    but_click<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 等待1s</span></span>
<span class="line">    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    input_data <span class="token operator">=</span> page<span class="token punctuation">.</span>ele<span class="token punctuation">(</span><span class="token string">&#39;xpath://*[@id=&quot;app&quot;]/div/div[1]/div/div/form/div[1]/div[2]/input[@class=&quot;zent-input&quot;]&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    but_div_msg <span class="token operator">=</span> page<span class="token punctuation">.</span>ele<span class="token punctuation">(</span><span class="token string">&#39;xpath://*[@id=&quot;app&quot;]/div/div[1]/div/div/form/div[2]/div[2]&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># 输入内容</span></span>
<span class="line">    input_data<span class="token punctuation">.</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;12345678911&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    but_div_msg<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 判断存在验证</span></span>
<span class="line">    index_html <span class="token operator">=</span> page<span class="token punctuation">.</span>html  <span class="token comment"># str</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token string">&#39;请完成安全验证&#39;</span> <span class="token keyword">in</span> index_html<span class="token punctuation">:</span></span>
<span class="line">        img <span class="token operator">=</span> page<span class="token punctuation">.</span>ele<span class="token punctuation">(</span><span class="token string">&#39;xpath:/html/body/div[4]/div/div/div&#39;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># 获取页面元素的位置</span></span>
<span class="line">        <span class="token keyword">if</span> img<span class="token punctuation">:</span></span>
<span class="line">            <span class="token comment"># 截图</span></span>
<span class="line">            log <span class="token operator">=</span> img<span class="token punctuation">.</span>rect<span class="token punctuation">.</span>corners</span>
<span class="line">            <span class="token comment"># 保存本地</span></span>
<span class="line">            page<span class="token punctuation">.</span>get_screenshot<span class="token punctuation">(</span>path<span class="token operator">=</span><span class="token string">&#39;./img&#39;</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">&#39;pic.jpg&#39;</span><span class="token punctuation">,</span> left_top<span class="token operator">=</span>log<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> right_bottom<span class="token operator">=</span>log<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">            ver_data<span class="token punctuation">(</span>page<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 获取图片进行自动化滑块验证</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">ver_data</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;./img/pic.jpg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;rb&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>
<span class="line">        <span class="token comment"># 读取图片的数据</span></span>
<span class="line">        data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        verify<span class="token punctuation">(</span>data<span class="token punctuation">,</span>page<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 设置云码函数</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">verify</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    url <span class="token operator">=</span> <span class="token string">&quot;http://api.jfbym.com/api/YmServer/customApi&quot;</span></span>
<span class="line">    data <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&quot;token&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;RJYp5oyWpTsacY3dlxYlxKh61ekP1XpiIZfwJU6sFUM&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&quot;type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;22222&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&quot;image&quot;</span><span class="token punctuation">:</span>  base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    _headers <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;application/json&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> headers<span class="token operator">=</span>_headers<span class="token punctuation">,</span> json<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    data_size <span class="token operator">=</span> jsonpath<span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token string">&#39;$..data..data&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span>data_size<span class="token punctuation">,</span><span class="token string">&quot;data_size&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment"># 设置动作链</span></span>
<span class="line">    ac <span class="token operator">=</span> Actions<span class="token punctuation">(</span>page<span class="token punctuation">)</span>  <span class="token comment"># //*[@id=&quot;slideBlockRef&quot;] //*[@id=&quot;slideIconRef&quot;]</span></span>
<span class="line">    ac<span class="token punctuation">.</span>hold<span class="token punctuation">(</span><span class="token string">&#39;xpath://*[@class=&quot;icon arrow&quot;]&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    ac<span class="token punctuation">.</span>right<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>data_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span></span>
<span class="line">    ac<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 释放鼠标左键</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line">    url <span class="token operator">=</span> <span class="token string">&#39;https://account.youzan.com/login?from_source=baidu_pz_shouye_l5&#39;</span></span>
<span class="line">    userData <span class="token operator">=</span> <span class="token string">r&#39;C:/Users/15116/Desktop/31-async与await和本地存储/youzan/data&#39;</span></span>
<span class="line">    page <span class="token operator">=</span> <span class="token boolean">None</span></span>
<span class="line">    setSpider<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,39)])])}const i=s(e,[["render",l]]),u=JSON.parse('{"path":"/spider/06-DrissionPage.html","title":"","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"DrissionPage","slug":"drissionpage","link":"#drissionpage","children":[]},{"level":2,"title":"基础使用","slug":"基础使用","link":"#基础使用","children":[{"level":3,"title":"基础属性与方法","slug":"基础属性与方法","link":"#基础属性与方法","children":[]},{"level":3,"title":"标签页管理","slug":"标签页管理","link":"#标签页管理","children":[]},{"level":3,"title":"浏览器配置","slug":"浏览器配置","link":"#浏览器配置","children":[]}]},{"level":2,"title":"元素","slug":"元素","link":"#元素","children":[{"level":3,"title":"获取元素内容和属性","slug":"获取元素内容和属性","link":"#获取元素内容和属性","children":[]},{"level":3,"title":"等待","slug":"等待","link":"#等待","children":[]},{"level":3,"title":"交互元素","slug":"交互元素","link":"#交互元素","children":[]}]},{"level":2,"title":"京东案例","slug":"京东案例","link":"#京东案例","children":[]},{"level":2,"title":"滑块验证案例","slug":"滑块验证案例","link":"#滑块验证案例","children":[]}],"git":{},"filePathRelative":"spider/06-DrissionPage.md"}');export{i as comp,u as data};
